<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send Email to Ministries</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
        .form-group { display: flex; align-items: center; justify-content: center; margin: 15px; }
        input { padding: 10px; width: 80%; max-width: 300px; border: 1px solid #ccc; border-radius: 5px; }
        .status-icon { font-size: 20px; margin-left: 10px; display: none; }
        .error { color: red; display: none; font-size: 14px; }
        button { padding: 10px 20px; background: #007BFF; color: white; border: none; cursor: pointer; margin: 10px; }
        button:hover { background: #0056b3; }
        #email { background: #f0f0f0; cursor: not-allowed; }
        #sendIndia, #sendHungary, #sendUGC { background: grey; cursor: not-allowed; opacity: 0.6; pointer-events: none; }
    </style>
</head>
<body>

    <h2>Enter Your Details</h2>

    <div class="form-group">
        <input type="text" id="name" placeholder="Enter Your Name" required>
        <span class="status-icon" id="nameIcon">‚ùó</span>
    </div>
    <p class="error" id="nameError">Please enter your name.</p>

    <div class="form-group">
        <input type="email" id="email" placeholder="Enter Your Email" required disabled>
        <span class="status-icon" id="emailIcon">‚ùó</span>
    </div>
    <p class="error" id="emailError">Please enter a valid email.</p>

    <h2>Send Pre-Filled Emails</h2>
    <button id="sendIndia" onclick="sendEmailToIndia()">üì© Email Ministry of Education, India</button>
    <button id="sendHungary" onclick="sendEmailToHungary()">üì© Email Ministry of Education, Hungary</button>
    <button id="sendUGC" onclick="sendEmailToUGC()">üì© Email UGC Chairman</button>

    <script>
        // Save form data to localStorage
        document.getElementById("name").addEventListener("input", function() {
            validateField(this, document.getElementById("nameIcon"), document.getElementById("nameError"));
            localStorage.setItem("formName", this.value.trim());
        });

        document.getElementById("email").addEventListener("input", function() {
            validateField(this, document.getElementById("emailIcon"), document.getElementById("emailError"));
            localStorage.setItem("formEmail", this.value.trim());
        });

        function validateField(input, icon, errorMsg) {
            icon.style.display = "inline"; 
            icon.innerText = "‚è≥"; // Show loading icon

            setTimeout(() => {
                if (input.value.trim() === "") {
                    icon.innerText = "‚ùó";
                    errorMsg.style.display = "block";
                    if (input.id === "name") {
                        document.getElementById("email").disabled = true;
                        document.getElementById("email").style.background = "#f0f0f0"; 
                    }
                } else {
                    icon.innerText = "‚úÖ";
                    errorMsg.style.display = "none";
                    if (input.id === "name") {
                        document.getElementById("email").disabled = false;
                        document.getElementById("email").style.background = "white"; 
                        document.getElementById("email").style.cursor = "text";
                    }
                }
                checkFormValidity();
            }, 500);
        }

        function unlockButton(buttonId) {
            let btn = document.getElementById(buttonId);
            btn.style.background = "#007BFF";
            btn.style.cursor = "pointer";
            btn.style.opacity = "1";
            btn.style.pointerEvents = "auto";
        }

        function lockButton(buttonId) {
            let btn = document.getElementById(buttonId);
            btn.style.background = "grey";
            btn.style.cursor = "not-allowed";
            btn.style.opacity = "0.6";
            btn.style.pointerEvents = "none";
        }

        // Check button unlocking conditions
        function checkFormValidity() {
            let nameValid = document.getElementById("nameIcon").innerText === "‚úÖ";
            let emailValid = document.getElementById("emailIcon").innerText === "‚úÖ";
            let formValid = nameValid && emailValid;

            // Unlock India button first
            formValid ? unlockButton("sendIndia") : lockButton("sendIndia");

            // Unlock Hungary button only after India email is sent
            const firstEmailSent = localStorage.getItem("firstEmailSent") === "true";
            if (formValid && firstEmailSent) {
                unlockButton("sendHungary");
            } else {
                lockButton("sendHungary");
            }

            // Unlock UGC button only after Hungary email is sent
            const secondEmailSent = localStorage.getItem("secondEmailSent") === "true";
            if (formValid && secondEmailSent) {
                unlockButton("sendUGC");
            } else {
                lockButton("sendUGC");
            }
        }

        function sendEmailToIndia() {
            let name = document.getElementById("name").value;
            let email = document.getElementById("email").value;
            let subject = "Urgent Request for Renewal of MoU Between India and Hungary for Stipendium Hungaricum Scholarship";
            let body = `Dear Sir/Madam,%0A%0A I am writing to bring to your attention the urgent need to renew the MoU between India and Hungary.%0A%0A Best regards,%0A${name}%0A${email}`;
            let mailtoLink = `mailto:contact.edu@gov.in?subject=${encodeURIComponent(subject)}&body=${body}`;

            localStorage.setItem("firstEmailSent", "true");
            checkFormValidity();
            window.location.href = mailtoLink;
        }

        function sendEmailToHungary() {
            let name = document.getElementById("name").value;
            let email = document.getElementById("email").value;
            let subject = "Request for MoU Renewal with India ‚Äì Stipendium Hungaricum Scholarship";
            let body = `Dear Sir/Madam,%0A%0A I kindly request the Hungarian Ministry of Education to expedite the renewal of the MoU with India.%0A%0A Best regards,%0A${name}%0A${email}`;
            let mailtoLink = `mailto:office@itm.gov.hu?subject=${encodeURIComponent(subject)}&body=${body}`;

            localStorage.setItem("secondEmailSent", "true");
            checkFormValidity();
            window.location.href = mailtoLink;
        }

        function sendEmailToUGC() {
            let name = document.getElementById("name").value;
            let email = document.getElementById("email").value;
            let subject = "Urgent Request for UGC‚Äôs Intervention in Renewal of MoU for Stipendium Hungaricum Scholarship";
            let body = `Dear Prof. V. Sudharsana,%0A%0A I am seeking your intervention in the renewal of the MoU between India and Hungary.%0A%0A Best regards,%0A${name}%0A${email}`;
            let mailtoLink = `mailto:vsudharsana.ugc@nic.in?subject=${encodeURIComponent(subject)}&body=${body}`;

            localStorage.clear();
            window.location.href = mailtoLink;
        }

        window.onload = function () {
            // Restore form data (Name and Email)
            document.getElementById("name").value = localStorage.getItem("formName") || "";
            document.getElementById("email").value = localStorage.getItem("formEmail") || "";

            // Trigger validation for both fields
            validateField(document.getElementById("name"), document.getElementById("nameIcon"), document.getElementById("nameError"));
            validateField(document.getElementById("email"), document.getElementById("emailIcon"), document.getElementById("emailError"));

            // **Delay checking buttons to ensure localStorage updates properly**
            setTimeout(checkFormValidity, 300);  // ‚úÖ Fix for Mobile
        };

    </script>

</body>
</html>
